# SDB

SDB 是一款使用 PHP 編寫的協程調試器工具。

* 使用簡單，只需要一行代碼即可開啟；
* 無需端口，可直接運行在 TTY 上；
* 零成本，可在生產環境使用，不影響性能；
* 功能強大，深度定製，量身打造類微型操作系統；

## 使用

只需要在你的代碼當中加入一行代碼：

```php
\Swow\Debug\Debugger::runOnTTY();
```

在終端中啟動運行時加上`-e`：

```shell
php -e -d extension=swow index.php
```

你就會在終端上得到這樣的輸出：

```bash
  ____    ____    ____  
 / ___|  |  _ \  | __ ) 
 \___ \  | | | | |  _ \ 
  ___) | | |_| | | |_) |
 |____/  |____/  |____/

Enter 'r' to run your program
> 
```

鍵入`r`開始調試之旅吧

## 支持命令

1. 查看當前所有協程狀態(`ps`)
2. 窺視協程(`co id`)
3. 進入協程(`attach id`)
4. 查看調用棧(`bt`)
5. 查棧幀(`f index`)
6. 打斷點(`b`)
7. 單步調試(`n`)
8. 恢復運行(`c`)
9. 查看更多源碼(`l`)
10. 打印變量(`p $var`)
11. 修改變量(`p $var =x`)
12. 執行命令(`p command0`)
13. 查看變量(`vars`)
14. 掃描殭屍協程(`z 時間`)
15. 殺死協程(`kill id`)
16. 殺死所有協程(`killall`)

## 退出調試器

調試完畢後可以鍵入`q`退出調試器。

如果進程中還存在協程在運行，那麼可以再次鍵入所設置的`關鍵字+回車`呼出調試器。

關鍵詞默認為`sdb`，可以在調用`runOnTTY()`方法時設置，如：

```php
\Swow\Debug\Debugger::runOnTTY('swow');
```

反之則直接退出。